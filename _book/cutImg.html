
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>在线裁图 · 工作中的一些收集</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="lizhicheng">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-sidebar-style/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code-editor/editor.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="example/style/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="problem.html" />
    
    
    <link rel="prev" href="diyPromise.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="css.html">
            
                <a href="css.html">
            
                    
                    css
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="css3.html">
            
                <a href="css3.html">
            
                    
                    图片倾斜效果css3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="perspective.html">
            
                <a href="perspective.html">
            
                    
                    正反面翻转
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="js.html">
            
                <a href="js.html">
            
                    
                    js
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="sf.html">
            
                <a href="sf.html">
            
                    
                    根据关系线生成布局
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="ball.html">
            
                <a href="ball.html">
            
                    
                    原生JS实现球面展示特效
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="drag1.html">
            
                <a href="drag1.html">
            
                    
                    拖动一
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="drag2.html">
            
                <a href="drag2.html">
            
                    
                    拖动二
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="selectMenu.html">
            
                <a href="selectMenu.html">
            
                    
                    文本框输入@触发选择菜单
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="textareaSelect.html">
            
                <a href="textareaSelect.html">
            
                    
                    textarea选中文字
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="nodelink.html">
            
                <a href="nodelink.html">
            
                    
                    node连线算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="yd.html">
            
                <a href="yd.html">
            
                    
                    仿有道云笔记网页剪报算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="textarea.html">
            
                <a href="textarea.html">
            
                    
                    基于Qcanvas实现画布即时渲染textarea输入的文本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="promise.html">
            
                <a href="promise.html">
            
                    
                    多个Promise实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="appendOrDelParendNode.html">
            
                <a href="appendOrDelParendNode.html">
            
                    
                    js 给元素添加、删除父标签
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="overflow.html">
            
                <a href="overflow.html">
            
                    
                    多行溢出省略号显示（ccs/js）实现！
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="diyPromise.html">
            
                <a href="diyPromise.html">
            
                    
                    实现类Promise
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.14" data-path="cutImg.html">
            
                <a href="cutImg.html">
            
                    
                    在线裁图
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="problem.html">
            
                <a href="problem.html">
            
                    
                    疑难问题
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="video.html">
            
                <a href="video.html">
            
                    
                    video标签不能自动播放问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >在线裁图</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>&#x5728;&#x7EBF;&#x88C1;&#x56FE; &#x5B9E;&#x73B0;&#x4E86;&#x4EE5;&#x4E0B;&#x529F;&#x80FD;
&#x6309;&#x6BD4;&#x4F8B;&#x62D6;&#x52A8;&#x88C1;&#x56FE;&#x7247; 
&#x81EA;&#x7531;&#x88C1;&#x56FE;
&#x56FE;&#x7247;&#x7F29;&#x653E; &#x4F4D;&#x7F6E;&#x79FB;&#x52A8;</p>
<p>
    <div class="zc-editor" data-id="12" data-single-tab="false">
      <div class="zc-top blue">
        <div class="zc-actions">
          <div class="zc-btn" data-text="JSFiddle" onclick="exportToCodepen(12);">
            <div>Export</div>
          </div>
        </div>
        
        <div class="zc-commands">
          <div id="html-btn12" class="zc-btn" onclick="toggle(&apos;html&apos;, 12)">HTML</div>
          <!--<div id="js-btn12" class="zc-btn" onclick="toggle('js', 12)">JavaScript</div>-->
          <!--<div id="css-btn12" class="zc-btn" onclick="toggle('css', 12)">CSS</div>-->
          <div id="result-btn12" class="zc-btn" onclick="toggle(&apos;result&apos;, 12)">Result</div>
        </div>
      </div>
      <div class="zc-content">
        <div id="html12" class="zc-cont" style="display:none; ">
          <div class="editor" id="codeeditor12" data-settings="{&quot;readOnly&quot;:&quot;true&quot;,&quot;mode&quot;:&quot;html&quot;,&quot;theme&quot;:&quot;github&quot;,&quot;maxLines&quot;:&quot;500&quot;}">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;
    &lt;meta name=&quot;robots&quot; content=&quot;noindex, nofollow&quot;/&gt;
    &lt;meta name=&quot;googlebot&quot; content=&quot;noindex, nofollow&quot;/&gt;
    &lt;title&gt;&#x5728;&#x7EBF;&#x88C1;&#x56FE;&#x793A;&#x4F8B; - JSRUN &#x9A71;&#x52A8;&lt;/title&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;./vue.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./main.css&quot;/&gt;

&lt;/head&gt;
&lt;body&gt;

&lt;div id=&quot;app&quot;&gt;

&lt;div class=&quot;cropper&quot; ref=&quot;cropper&quot;&gt;

    &lt;div class=&quot;bg&quot; v-if=&quot;base64!=&apos;&apos;&quot;  :style=&quot;{
        width:bg_width+&apos;px&apos;,
        height:bg_height+&apos;px&apos;,
        transform:&apos;scale(&apos;+scaleX+&apos;,&apos;+scaleY+&apos;) translate3d(&apos;+(translateX/scaleBase)+&apos;px,&apos;+(translateY/scaleBase)+&apos;px,0px)&apos;,
    }&quot;&gt;
        &lt;img  :src=&quot;base64&quot; ref=&quot;cut_img&quot; /&gt;
    &lt;/div&gt;

    &lt;div class=&quot;cropper-drag cropper-move&quot; id=&quot;cropper-drag&quot;&gt;

    &lt;/div&gt;

    &lt;div class=&quot;cut_cover&quot; id=&quot;cut_cover&quot; ref=&quot;cut_cover&quot;
    v-bind:style=&quot;{
        width:cut_width+&apos;px&apos;,
        height:cut_height+&apos;px&apos;,
        left:cut_translateX+&apos;px&apos;,
        top:cut_translateY+&apos;px&apos;

    }&quot;&gt;
    &lt;div class=&quot;img_cover&quot;&gt;
        &lt;div class=&quot;front&quot; v-if=&quot;base64!=&apos;&apos;&quot; ref=&quot;front&quot;  :style=&quot;{
            width:bg_width+&apos;px&apos;,
            height:bg_height+&apos;px&apos;,
            transform:&apos;scale(&apos;+scaleX+&apos;,&apos;+scaleY+&apos;) translate3d(&apos;+(frontX/scaleBase)+&apos;px,&apos;+(frontY/scaleBase)+&apos;px,0px)&apos;
        }&quot;&gt;
            &lt;img  :src=&quot;base64&quot; ref=&quot;front_img&quot;/&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div id=&quot;tip&quot;&gt;{{cut_width | format}}x{{cut_height | format}}&lt;/div&gt;

    &lt;template v-if=&quot;!cut_moving&quot;&gt;
    &lt;span id= &quot;point1&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point2&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point3&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point4&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point5&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point6&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point7&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point8&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
        
    &lt;/template&gt;

  
    &lt;/div&gt;
&lt;/div&gt;


&lt;input id=&quot;file&quot; type=&quot;file&quot; @change=&quot;addImg&quot; accept=&quot;image/png,image/jpeg,image/gif,image/jpg&quot;&gt;


&lt;button @click=&quot;cut4&quot;&gt;&#x622A;&#x56FE;&lt;/button&gt;
&lt;/div&gt;

&lt;script&gt;
    var Event = {};
Event.addEvents = function(target,eventType,handle){
    if(target.addEventListener){
        Event.addEvents = function(target,eventType,handle){
            target.addEventListener(eventType,handle,false);
        };
    }else{
        Event.addEvents = function(target,eventType,handle){
            target.attachEvent(&apos;on&apos;+eventType,function(){
                handle.call(target,arguments);
            });
        };
    };
    Event.addEvents(target,eventType,handle);
};
window.onload = function(){
    new Vue({
        el: &apos;#app&apos;,
        data: {
            base64:&apos;&apos;,
            cropper_width:0,
            cropper_height:0,
            img_width:0,
            img_height:0,

            bg_width:0,
            bg_height:0,
            old_bg_width:0,
            old_bg_height:0,

            disX:0,
            disY:0,

            translateX:0,
            translateY:0,
            init_translateX:-1,
            init_translateY:-1,
            init_centerX:-1,
            init_centerY:-1,
            scaleBase:1,
            scaleX:1,
            scaleY:1,

            drag:null,

            cut_width:100,
            cut_height:100,
            fixed: false, // &#x662F;&#x5426;&#x5F00;&#x542F;&#x622A;&#x56FE;&#x6846;&#x5BBD;&#x9AD8;&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;
            fixedNumber: [3, 4], // &#x622A;&#x56FE;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x6BD4;&#x4F8B;
            fixedRate:0,
            old_cut_width:100,
            old_cut_height:100,
            cut_translateX:0,
            cut_translateY:0,

            cut_maxLeft:0,
            cut_maxTop:0,

            cut_moving:false,   //&#x88C1;&#x526A;&#x6846;&#x662F;&#x5426;&#x6B63;&#x5728;&#x79FB;&#x52A8;

           


        },
        filters:{
            format:function(v){
                return parseInt(v);
            }
        },
        methods:{
          
            init_cut:function(){
                if(this.fixed){
                    this.fixedRate = this.fixedNumber[0]/this.fixedNumber[1];
                    //&#x4EE5;&#x5BBD;&#x5EA6;&#x4E3A;&#x51C6; &#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x9AD8;
                    this.cut_height = this.cut_width/this.fixedRate;
                }
            },
            limitRange:function(){  //&#x88C1;&#x526A;&#x6846;&#x9650;&#x5236;&#x5728;&#x5212;&#x52A8;&#x533A;&#x57DF;&#x5185;
                this.cut_maxLeft = this.cropper_width - this.cut_width;
                this.cut_maxTop = this.cropper_height - this.cut_height;
            },
            getPosition:function(event){
                var e = event || window.event;
                var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
                var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
                var x = e.pageX || e.clientX + scrollX;
                var y = e.pageY || e.clientY + scrollY; 
                return {
                    x:x,
                    y:y
                }
            },
            initEvent:function(){
                var _this = this;
                Event.addEvents(this.$refs.cropper,&apos;mousewheel&apos;,function(event){
                    var delta = 0;
                    if (!event) event = window.event;
                    if (event.wheelDelta) {//IE&#x3001;chrome&#x6D4F;&#x89C8;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x662F;wheelDelta&#xFF0C;&#x5E76;&#x4E14;&#x503C;&#x4E3A;&#x201C;&#x6B63;&#x8D1F;120&#x201D;
                        delta = event.wheelDelta/120; 
                        if (window.opera) delta = -delta;//&#x56E0;&#x4E3A;IE&#x3001;chrome&#x7B49;&#x5411;&#x4E0B;&#x6EDA;&#x52A8;&#x662F;&#x8D1F;&#x503C;&#xFF0C;FF&#x662F;&#x6B63;&#x503C;&#xFF0C;&#x4E3A;&#x4E86;&#x5904;&#x7406;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x5728;&#x6B64;&#x53D6;&#x53CD;&#x5904;&#x7406;
                    } else if (event.detail) {//FF&#x6D4F;&#x89C8;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x662F;detail,&#x5176;&#x503C;&#x4E3A;&#x201C;&#x6B63;&#x8D1F;3&#x201D;
                        delta = -event.detail/3;
                    }

                   
                    if(_this.base64 != &apos;&apos;){

                        if(delta &lt;0){
                            _this.scaleBase +=0.010;
                        }else{
                            _this.scaleBase -=0.010;
                        }
                        _this.scaleBase = _this.scaleBase&lt;=0?0:_this.scaleBase;

                        _this.scaleX = _this.scaleBase;
                        _this.scaleY = _this.scaleBase;

                        // _this.bg_width = _this.old_bg_width * _this.scaleBase;
                        // _this.bg_height = _this.old_bg_height * _this.scaleBase;
                        // console.log(_this.bg_width);
                        // console.log(_this.bg_height);

                        // _this.initBgImgPosition();
                    }

                })

                Event.addEvents(this.$refs.cropper,&apos;mousedown&apos;,function(event){
             
                    var tmp = _this.getPosition(event);
                    var x = tmp.x,y=tmp.y;
                        
                        if(event.target.id == &apos;cropper-drag&apos;){  //&#x80CC;&#x666F;&#x56FE;&#x7684;&#x8986;&#x76D6;&#x5C42;
                            _this.disX = x - _this.translateX;
                            _this.disY = y - _this.translateY;
                        }else if(event.target.className == &apos;point&apos;){
                            _this.disX = x - event.target.offsetLeft;
                            _this.disY = y - event.target.offsetTop;

                            //&#x66F4;&#x65B0;&#x88C1;&#x526A;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x4F4D;&#x7F6E;&#x8BB0;&#x5F55;
                            _this.old_cut_width = _this.$refs.cut_cover.offsetWidth;
                            _this.old_cut_height = _this.$refs.cut_cover.offsetHeight;
                            _this.old_cut_translateX = _this.$refs.cut_cover.offsetLeft;
                            _this.old_cut_translateY = _this.$refs.cut_cover.offsetTop;


                        }else{
                            _this.disX = x - event.target.offsetLeft;
                            _this.disY = y - event.target.offsetTop;
                        }

                    _this.drag = event.target;
                })
                Event.addEvents(this.$refs.cropper,&apos;mousemove&apos;,function(event){

                    if(_this.drag === null){
                        return false;
                    }

                    var tmp = _this.getPosition(event);
                    var x = tmp.x,y=tmp.y;
                    
                    if(_this.drag.id == &apos;cropper-drag&apos;){ //&#x5728;&#x80CC;&#x666F;&#x8986;&#x76D6;&#x5C42;&#x6ED1;&#x52A8; &#x79FB;&#x52A8;&#x5E95;&#x90E8;&#x56FE;&#x7247; 

                        _this.translateX = x - _this.disX;
                        _this.translateY = y - _this.disY;
                    }

                    if(_this.drag.id == &apos;cut_cover&apos;){ //&#x79FB;&#x52A8;&#x88C1;&#x526A;&#x6846;
                         _this.cut_moving = true; 
                        

                        //&#x88C1;&#x526A;&#x6846;&#x9650;&#x5236;&#x5728;&#x5BB9;&#x5668;&#x5185;
                        var tmpX = x - _this.disX;
                        var tmpY = y - _this.disY;
                        tmpX = tmpX&lt;=0?0:(tmpX&gt;=_this.cut_maxLeft?_this.cut_maxLeft:tmpX);
                        tmpY = tmpY&lt;=0?0:(tmpY&gt;=_this.cut_maxTop?_this.cut_maxTop:tmpY);
                        _this.cut_translateX = tmpX;
                        _this.cut_translateY = tmpY;
                    }
                    if(_this.drag.id == &apos;point1&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;&#x3001;&#x4F4D;&#x7F6E;[x,y]
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){ //&#x5982;&#x679C;&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B; &#x5C31;&#x4EE5;&#x5BBD;&#x4E3A;&#x51C6; &#x5BF9;&#x9AD8;&#x5EA6;&#x505A;&#x9650;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = _this.old_cut_height-(y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        // &#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B;  &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);


                    }

                    if(_this.drag.id == &apos;point2&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x9AD8; &#x4F4D;&#x7F6E;y
 

                        // _this.cut_width = _this.old_cut_width-(x - _this.disX);
                        _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x9AD8;&#x4E3A;&#x51C6;
                            _this.cut_width = _this.cut_height * _this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);


                         // &#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B;  &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);
                    }
                    if(_this.drag.id == &apos;point3&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;&#x3001;&#x4F4D;&#x7F6E;y
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = _this.old_cut_height-(y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);
                    }
                    if(_this.drag.id == &apos;point4&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;

                    }
                    if(_this.drag.id == &apos;point5&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = (y - _this.disY+5);
                        }


                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);
                    }
                    if(_this.drag.id == &apos;point6&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x9AD8;
 

                        // _this.cut_width = (x - _this.disX+5);
                        _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_width = _this.cut_height * _this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);
                    }
                    if(_this.drag.id == &apos;point7&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8; &#x4F4D;&#x7F6E;x
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = (y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);

                    }
                    if(_this.drag.id == &apos;point8&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD; &#x4F4D;&#x7F6E;x
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);


                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);


                    }


                    
                })
                Event.addEvents(this.$refs.cropper,&apos;mouseup&apos;,function(){
                    _this.cut_moving = false;
                    _this.drag = null
                })
            },
            initBgImgPosition:function(){ 
                //&#x521D;&#x59CB;&#x5316;&#x80CC;&#x666F;&#x56FE;&#x7247;&#x4F4D;&#x7F6E; &#x4FDD;&#x8BC1;&#x56FE;&#x7247;&#x5168;&#x90E8;&#x653E;&#x5230;&#x9884;&#x89C8;&#x6846;&#x5185; &#x5C45;&#x4E2D;&#x663E;&#x793A;
                //&#x60C5;&#x51B5;&#x4E00; &#x56FE;&#x7247;&#x5BBD;&#x9AD8;&#x5EA6;&#x90FD;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x663E;&#x793A;&#x6846;&#x7684;&#x5BBD;&#x9AD8; &#x6240;&#x4EE5;&#x56FE;&#x7247;&#x4E0D;&#x9700;&#x8981;&#x7F29;&#x653E; 
                if((this.img_width &lt;= this.cropper_width) &amp;&amp; (this.img_height &lt;= this.cropper_height)){
                    this.bg_width = this.img_width;
                    this.bg_height = this.img_height; 
                }else{
                    //&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x6BD4;&#x4F8B;
                    var cropper_rate = this.cropper_width/this.cropper_height;
                    var img_rate = this.img_width/this.img_height;
                    if(cropper_rate &gt;= img_rate){  //&#x4EE5;&#x56FE;&#x7247;&#x9AD8;&#x5EA6;&#x663E;&#x793A;&#x5168;&#x4E3A;&#x51C6; 
                        this.bg_height = this.cropper_height;
                        this.bg_width =  this.img_width/(this.img_height/this.cropper_height); 
                    }else{
                        this.bg_width = this.cropper_width;
                        this.bg_height =  this.img_height/(this.img_width/this.cropper_width); 
                    }
                }

                if(this.old_bg_width == 0){
                    this.old_bg_width = this.bg_width;
                    this.old_bg_height = this.bg_height;
                }


                this.translateX = (this.cropper_width - this.bg_width) * 0.5;
                this.translateY = (this.cropper_height - this.bg_height) * 0.5;

                if(this.init_translateX == -1){
                    this.init_translateX = this.translateX;
                    this.init_translateY = this.translateY;

                }

            },
            toBase64:function(file){
                var _this = this;
                let reader = new FileReader();
                reader.onload =  function(evt) {
                  var base64 = evt.target.result

                      var img = new Image();
                      img.onload = function(){
                          
                        _this.img_width = this.width;
                        _this.img_height = this.height;

                        //&#x521D;&#x59CB;&#x5316;
                        _this.scaleBase = 1,
                        _this.scaleX = 1,
                        _this.scaleY = 1,
                        _this.old_bg_width = 0;
                        _this.init_translateX = -1;

                        _this.initBgImgPosition();
                        _this.base64 = base64;
                      } 
                      img.src = base64;
                };
                reader.readAsDataURL(file); 
            },
            addImg:function(e){ 
                this.toBase64(e.target.files[0]);
            }, 
            cut4:function(){  //&#x5BF9;cut3&#x7684;&#x4F18;&#x5316;  &#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x6D4B;&#x8BD5;&#x9A8C;&#x8BC1;
                 if(this.base64 == &apos;&apos;){
                    return false;
                } 
 
                //&#x56E0;&#x4E3A;scale&#x6837;&#x5F0F;&#x4E0D;&#x80FD;&#x5177;&#x4F53;&#x4F53;&#x73B0;&#x5B9E;&#x9645;&#x5927;&#x5C0F; &#x6240;&#x4EE5;&#x5F97;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x65F6;&#x5019; &#x5E95;&#x56FE;&#x76F8;&#x5BF9;&#x4E8E;&#x6574;&#x4F53;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                var w = this.bg_width * this.scaleBase;
                var h = this.bg_height * this.scaleBase;

                // console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x5BBD;&#x5EA6;&#xFF1A;&apos;+w);
                // console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x9AD8;&#x5EA6;&#xFF1A;&apos;+h);


                //&#x7F29;&#x653E;&#x540E;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;
                // var off_scale_x = x - w * 0.5;
                // var off_scale_y = y - h * 0.5;
                // var off_scale_x = x - this.cropper_width * 0.5;
                // var off_scale_y = y - this.cropper_height * 0.5;
                // var off_scale_x = this.cropper_width*0.5 - w * 0.5;
                // var off_scale_y = this.cropper_height*0.5 - h * 0.5;
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateX:&apos;+this.init_translateX);
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateY:&apos;+this.init_translateY);

                //&#x8BA1;&#x7B97;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x521D;&#x59CB;&#x4F4D;&#x7F6E;&#x79FB;&#x52A8;&#x4E86;&#x591A;&#x5C11; 
                //&#x6B63;&#x503C;&#x662F;&#x5411;&#x4E0A; &#x5411;&#x5DE6;&#x79FB;&#x4E86;
                //&#x8D1F;&#x503C;&#x662F;&#x5411;&#x4E0B; &#x5411;&#x53F3;&#x79FB;&#x4E86;
                var dis_x = this.init_translateX - this.translateX;
                var dis_y = this.init_translateY - this.translateY;
                // console.log(&apos;dis_x:&apos;+dis_x);
                // console.log(&apos;dis_y:&apos;+dis_y);

                // var off_scale_x = (this.cropper_width - w)*0.5-dis_x;
                // var off_scale_y = (this.cropper_height - h)*0.5-dis_y;
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;x:&apos;+this.init_centerX);
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;y:&apos;+this.init_centerY);

                var center_x = (this.init_centerX - dis_x);
                var center_y = (this.init_centerY - dis_y);
                
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;x:&apos;+center_x);
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;y:&apos;+center_y);

                var off_scale_x = center_x - w*0.5;
                var off_scale_y = center_y - h*0.5;



                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;x&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_x);
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;y&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_y);

                    var canvas = document.createElement(&apos;canvas&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);


                canvas.width = this.cut_width;
                canvas.height = this.cut_height;


                //&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x6574;&#x4F53;&#x5C0F;&#x4E8E;&#x5BB9;&#x5668;
                if((this.img_width &lt;= this.cropper_width) &amp;&amp; (this.img_height &lt;= this.cropper_height)){
                    ctx.drawImage(
                        this.$refs.cut_img,
                        (this.cut_translateX - (off_scale_x))/this.scaleBase,
                        (this.cut_translateY - (off_scale_y))/this.scaleBase, 

                        this.cut_width/this.scaleBase,
                        this.cut_height/this.scaleBase,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL(&quot;image/png&quot;, 1.0));
                }else{
                    // console.log(&apos;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x5927;&#x4E8E;&#x5BB9;&#x5668;&apos;);
                    //&#x8BA1;&#x7B97;&#x521D;&#x59CB;&#x663E;&#x793A;&#x56FE;&#x7247;&#x65F6; &#x5C3A;&#x5BF8;&#x4E0E;&#x539F;&#x56FE;&#x7684;&#x6BD4;&#x4F8B;
                    var cropper_rate = this.cropper_width/this.cropper_height;
                    var img_rate = this.img_width/this.img_height;
                    if(cropper_rate &gt;= img_rate){  //&#x4EE5;&#x56FE;&#x7247;&#x9AD8;&#x5EA6;&#x663E;&#x793A;&#x5168;&#x4E3A;&#x51C6; 
                        // console.log(&apos;&#x4EE5;&#x9AD8;&#x5EA6;&#x6BD4;&#x4F8B;&#x4E3A;&#x51C6;&apos;)
                        var scale_rate = this.cropper_height/this.img_height;

                    }else{
                        // console.log(&apos;&#x4EE5;&#x5BBD;&#x5EA6;&#x6BD4;&#x4F8B;&#x4E3A;&#x51C6;&apos;)

                        var scale_rate = this.cropper_width/this.img_width;
                        // console.log(&apos;&#x521D;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E0E;&#x539F;&#x56FE;&#x6BD4;&#x4F8B;&#xFF1A;&apos;+scale_rate);
                    }


                    ctx.drawImage(
                        this.$refs.cut_img,
                        ((this.cut_translateX - (off_scale_x))/this.scaleBase)/scale_rate,
                        ((this.cut_translateY - (off_scale_y))/this.scaleBase)/scale_rate, 

                        (this.cut_width/this.scaleBase)/scale_rate,
                        (this.cut_height/this.scaleBase)/scale_rate,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL(&quot;image/png&quot;, 1.0));



                }

                

            },
            cut3:function(){  //&#x7B97;&#x5BF9;&#x4E86; &#x4F46;&#x662F;&#x590D;&#x6742;  &#x591A;&#x4E86;&#x4E00;&#x5C42;&#x4E34;&#x65F6;&#x753B;&#x5E03;&#x7684;&#x8FC7;&#x7A0B;
                if(this.base64 == &apos;&apos;){
                    return false;
                } 
 
                //&#x56E0;&#x4E3A;scale&#x6837;&#x5F0F;&#x4E0D;&#x80FD;&#x5177;&#x4F53;&#x4F53;&#x73B0;&#x5B9E;&#x9645;&#x5927;&#x5C0F; &#x6240;&#x4EE5;&#x5F97;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x65F6;&#x5019; &#x5E95;&#x56FE;&#x76F8;&#x5BF9;&#x4E8E;&#x6574;&#x4F53;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                var w = this.bg_width * this.scaleBase;
                var h = this.bg_height * this.scaleBase;

                console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x5BBD;&#x5EA6;&#xFF1A;&apos;+w);
                console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x9AD8;&#x5EA6;&#xFF1A;&apos;+h);


                //&#x7F29;&#x653E;&#x540E;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;
                // var off_scale_x = x - w * 0.5;
                // var off_scale_y = y - h * 0.5;
                // var off_scale_x = x - this.cropper_width * 0.5;
                // var off_scale_y = y - this.cropper_height * 0.5;
                // var off_scale_x = this.cropper_width*0.5 - w * 0.5;
                // var off_scale_y = this.cropper_height*0.5 - h * 0.5;
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateX:&apos;+this.init_translateX);
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateY:&apos;+this.init_translateY);

                console.log(&apos;&#x5F53;&#x524D;&#x56FE;&#x7247;translateX:&apos;+this.translateX);
                console.log(&apos;&#x5F53;&#x524D;&#x56FE;&#x7247;translateY:&apos;+this.translateY);
                console.log(this.init_translateX - this.translateX);
                //&#x8BA1;&#x7B97;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x521D;&#x59CB;&#x4F4D;&#x7F6E;&#x79FB;&#x52A8;&#x4E86;&#x591A;&#x5C11; 
                //&#x6B63;&#x503C;&#x662F;&#x5411;&#x4E0A; &#x5411;&#x5DE6;&#x79FB;&#x4E86;
                //&#x8D1F;&#x503C;&#x662F;&#x5411;&#x4E0B; &#x5411;&#x53F3;&#x79FB;&#x4E86;
                var dis_x = this.init_translateX - this.translateX;
                var dis_y = this.init_translateY - this.translateY;
                console.log(&apos;dis_x:&apos;+dis_x);
                console.log(&apos;dis_y:&apos;+dis_y);

                // var off_scale_x = (this.cropper_width - w)*0.5-dis_x;
                // var off_scale_y = (this.cropper_height - h)*0.5-dis_y;
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;x:&apos;+this.init_centerX);
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;y:&apos;+this.init_centerY);

                var center_x = (this.init_centerX - dis_x);
                var center_y = (this.init_centerY - dis_y);
                
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;x:&apos;+center_x);
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;y:&apos;+center_y);

                var off_scale_x = center_x - w*0.5;
                var off_scale_y = center_y - h*0.5;



                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;x&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_x);
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;y&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_y);

 

                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = w;
                old_canvas.height = h;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.img_width,this.img_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )

                    // console.log(old_canvas.toDataURL());


                setTimeout(()=&gt;{
                    var canvas = document.createElement(&apos;canvas&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);


                canvas.width = this.cut_width;
                canvas.height = this.cut_height;

                ctx.drawImage(
                        old_canvas,
                        this.cut_translateX - (off_scale_x),
                        this.cut_translateY - (off_scale_y), 

                        this.cut_width,
                        this.cut_height,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL());
                },200)
                


            },
            cut2:function(){  //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;
                if(this.base64 == &apos;&apos;){
                    return false;
                }
                console.log(this.$refs.front.getBoundingClientRect());



                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )


                setTimeout(()=&gt;{

                    var canvas = document.createElement(&apos;canvas&apos;);
                    var ctx = canvas.getContext(&apos;2d&apos;);
                    ctx.scale(this.scaleBase,this.scaleBase);

    
                    canvas.width = this.cut_width;
                    canvas.height = this.cut_height;

                    

                    // var startX = -(this.frontX);
                    // var startY = -(this.frontY);

                    //&#x7F29;&#x653E;&#x540E;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                    var startX = (-this.translateX/this.scaleBase)*0.5;
                    var startY = (-this.translateY/this.scaleBase)*0.5;
                    console.log(startX);
                    console.log(startY);



                    ctx.drawImage(
                        old_canvas,
                        startX,
                        startY, 

                        this.cut_width,
                        this.cut_height,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL());

                },200)



                // var canvas = document.createElement(&apos;canvas&apos;);
                // var ctx = canvas.getContext(&apos;2d&apos;);
                // ctx.scale(this.scaleBase,this.scaleBase);

 
                // canvas.width = this.cut_width;
                // canvas.height = this.cut_height;
                // var startX = this.cut_translateX - this.translateX/this.scaleBase;
                // var startY = this.cut_translateY - this.translateY/this.scaleBase;

                // console.log(startX);
                // console.log(startY);


                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,
                //     startY, 

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());
            },
            cut1:function(){  //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;

                if(this.base64 == &apos;&apos;){
                    return false;
                }

                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )

                console.log(old_canvas.toDataURL())

                var canvas = document.createElement(&apos;canvas&apos;);
                canvas.width = this.cut_width;
                canvas.height = this.cut_height;
                var ctx = canvas.getContext(&apos;2d&apos;);

                var startX = this.cut_translateX - this.translateX;
                var startY = this.cut_translateY - this.translateY;
                console.log(startX);
                console.log(startY);


              

                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,startY,

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());

                


            },

            cut:function(){ //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;

                if(this.base64 == &apos;&apos;){
                    return false;
                }
                var old_canvas = document.createElement(&apos;canvas&apos;);
                var canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);
                // ctx.scale(this.scaleBase,this.scaleBase);

                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;

                canvas.width = this.cut_width;
                canvas.height = this.cut_height;
                console.log(this.$refs.front_img.offsetWidth*this.scaleBase);

                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0,this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                    )

                console.log(old_canvas.toDataURL());
                setTimeout(()=&gt;{

                    ctx.drawImage(
                        old_canvas,
                        -(this.frontX),
                        -(this.frontY),
                        this.cut_width*this.scaleBase,
                        this.cut_height*this.scaleBase,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                console.log(canvas.toDataURL());

                },200)
                   

                // var new_translateX = this.translateX/this.scaleBase;
                // var new_translateY = this.translateY/this.scaleBase;
                // var new_width = this.cut_width*this.scaleBase;
                // var new_height = this.cut_height*this.scaleBase;
                // console.log(&apos;-----&apos;)
                // console.log(this.scaleBase);
                // console.log(new_translateX);
                // console.log(new_width);

                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     this.cut_translateX - new_translateX,
                //     this.cut_translateX - new_translateY, 

                //     new_width,
                //     new_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());



                // var startX = this.cut_translateX - this.translateX/this.scaleBase;
                // var startY = this.cut_translateY - this.translateY/this.scaleBase;

                // console.log(startX);
                // console.log(startY);


                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,
                //     startY, 

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());

            }
        },
        mounted(){
            this.cropper_width = this.$refs.cropper.offsetWidth;
            this.cropper_height = this.$refs.cropper.offsetHeight;

            this.init_centerX = this.cropper_width * 0.5;
            this.init_centerY = this.cropper_height * 0.5;
            

            this.init_cut();

            this.limitRange();
            this.initEvent();
        },
        computed:{
            frontX(){
                return this.translateX-this.cut_translateX;
            },
            frontY(){
                return this.translateY-this.cut_translateY;
            }
        }
    })
}

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

</div>
        </div><div id="result12" class="zc-cont" style="overflow:hidden;" data-height="500px"></div>
        <div id="js12" class="zc-cont" style="display:none">
          <pre id="js-code12" class="prettyprint linenums"></pre>
        </div>
  
        <div id="css12" class="zc-cont" style="display:none">
          <pre id="css-code12" class="prettyprint linenums"></pre>
        </div>
  
      </div>
  
      <input type="hidden" id="init-html12" value="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;
    &lt;meta name=&quot;robots&quot; content=&quot;noindex, nofollow&quot;/&gt;
    &lt;meta name=&quot;googlebot&quot; content=&quot;noindex, nofollow&quot;/&gt;
    &lt;title&gt;&#x5728;&#x7EBF;&#x88C1;&#x56FE;&#x793A;&#x4F8B; - JSRUN &#x9A71;&#x52A8;&lt;/title&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;./vue.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./main.css&quot;/&gt;

&lt;/head&gt;
&lt;body&gt;

&lt;div id=&quot;app&quot;&gt;

&lt;div class=&quot;cropper&quot; ref=&quot;cropper&quot;&gt;

    &lt;div class=&quot;bg&quot; v-if=&quot;base64!=&apos;&apos;&quot;  :style=&quot;{
        width:bg_width+&apos;px&apos;,
        height:bg_height+&apos;px&apos;,
        transform:&apos;scale(&apos;+scaleX+&apos;,&apos;+scaleY+&apos;) translate3d(&apos;+(translateX/scaleBase)+&apos;px,&apos;+(translateY/scaleBase)+&apos;px,0px)&apos;,
    }&quot;&gt;
        &lt;img  :src=&quot;base64&quot; ref=&quot;cut_img&quot; /&gt;
    &lt;/div&gt;

    &lt;div class=&quot;cropper-drag cropper-move&quot; id=&quot;cropper-drag&quot;&gt;

    &lt;/div&gt;

    &lt;div class=&quot;cut_cover&quot; id=&quot;cut_cover&quot; ref=&quot;cut_cover&quot;
    v-bind:style=&quot;{
        width:cut_width+&apos;px&apos;,
        height:cut_height+&apos;px&apos;,
        left:cut_translateX+&apos;px&apos;,
        top:cut_translateY+&apos;px&apos;

    }&quot;&gt;
    &lt;div class=&quot;img_cover&quot;&gt;
        &lt;div class=&quot;front&quot; v-if=&quot;base64!=&apos;&apos;&quot; ref=&quot;front&quot;  :style=&quot;{
            width:bg_width+&apos;px&apos;,
            height:bg_height+&apos;px&apos;,
            transform:&apos;scale(&apos;+scaleX+&apos;,&apos;+scaleY+&apos;) translate3d(&apos;+(frontX/scaleBase)+&apos;px,&apos;+(frontY/scaleBase)+&apos;px,0px)&apos;
        }&quot;&gt;
            &lt;img  :src=&quot;base64&quot; ref=&quot;front_img&quot;/&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div id=&quot;tip&quot;&gt;{{cut_width | format}}x{{cut_height | format}}&lt;/div&gt;

    &lt;template v-if=&quot;!cut_moving&quot;&gt;
    &lt;span id= &quot;point1&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point2&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point3&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point4&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point5&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point6&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point7&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
    &lt;span id= &quot;point8&quot; class=&quot;point&quot;&gt;&lt;/span&gt;
        
    &lt;/template&gt;

  
    &lt;/div&gt;
&lt;/div&gt;


&lt;input id=&quot;file&quot; type=&quot;file&quot; @change=&quot;addImg&quot; accept=&quot;image/png,image/jpeg,image/gif,image/jpg&quot;&gt;


&lt;button @click=&quot;cut4&quot;&gt;&#x622A;&#x56FE;&lt;/button&gt;
&lt;/div&gt;

&lt;script&gt;
    var Event = {};
Event.addEvents = function(target,eventType,handle){
    if(target.addEventListener){
        Event.addEvents = function(target,eventType,handle){
            target.addEventListener(eventType,handle,false);
        };
    }else{
        Event.addEvents = function(target,eventType,handle){
            target.attachEvent(&apos;on&apos;+eventType,function(){
                handle.call(target,arguments);
            });
        };
    };
    Event.addEvents(target,eventType,handle);
};
window.onload = function(){
    new Vue({
        el: &apos;#app&apos;,
        data: {
            base64:&apos;&apos;,
            cropper_width:0,
            cropper_height:0,
            img_width:0,
            img_height:0,

            bg_width:0,
            bg_height:0,
            old_bg_width:0,
            old_bg_height:0,

            disX:0,
            disY:0,

            translateX:0,
            translateY:0,
            init_translateX:-1,
            init_translateY:-1,
            init_centerX:-1,
            init_centerY:-1,
            scaleBase:1,
            scaleX:1,
            scaleY:1,

            drag:null,

            cut_width:100,
            cut_height:100,
            fixed: false, // &#x662F;&#x5426;&#x5F00;&#x542F;&#x622A;&#x56FE;&#x6846;&#x5BBD;&#x9AD8;&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;
            fixedNumber: [3, 4], // &#x622A;&#x56FE;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x6BD4;&#x4F8B;
            fixedRate:0,
            old_cut_width:100,
            old_cut_height:100,
            cut_translateX:0,
            cut_translateY:0,

            cut_maxLeft:0,
            cut_maxTop:0,

            cut_moving:false,   //&#x88C1;&#x526A;&#x6846;&#x662F;&#x5426;&#x6B63;&#x5728;&#x79FB;&#x52A8;

           


        },
        filters:{
            format:function(v){
                return parseInt(v);
            }
        },
        methods:{
          
            init_cut:function(){
                if(this.fixed){
                    this.fixedRate = this.fixedNumber[0]/this.fixedNumber[1];
                    //&#x4EE5;&#x5BBD;&#x5EA6;&#x4E3A;&#x51C6; &#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x9AD8;
                    this.cut_height = this.cut_width/this.fixedRate;
                }
            },
            limitRange:function(){  //&#x88C1;&#x526A;&#x6846;&#x9650;&#x5236;&#x5728;&#x5212;&#x52A8;&#x533A;&#x57DF;&#x5185;
                this.cut_maxLeft = this.cropper_width - this.cut_width;
                this.cut_maxTop = this.cropper_height - this.cut_height;
            },
            getPosition:function(event){
                var e = event || window.event;
                var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
                var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
                var x = e.pageX || e.clientX + scrollX;
                var y = e.pageY || e.clientY + scrollY; 
                return {
                    x:x,
                    y:y
                }
            },
            initEvent:function(){
                var _this = this;
                Event.addEvents(this.$refs.cropper,&apos;mousewheel&apos;,function(event){
                    var delta = 0;
                    if (!event) event = window.event;
                    if (event.wheelDelta) {//IE&#x3001;chrome&#x6D4F;&#x89C8;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x662F;wheelDelta&#xFF0C;&#x5E76;&#x4E14;&#x503C;&#x4E3A;&#x201C;&#x6B63;&#x8D1F;120&#x201D;
                        delta = event.wheelDelta/120; 
                        if (window.opera) delta = -delta;//&#x56E0;&#x4E3A;IE&#x3001;chrome&#x7B49;&#x5411;&#x4E0B;&#x6EDA;&#x52A8;&#x662F;&#x8D1F;&#x503C;&#xFF0C;FF&#x662F;&#x6B63;&#x503C;&#xFF0C;&#x4E3A;&#x4E86;&#x5904;&#x7406;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x5728;&#x6B64;&#x53D6;&#x53CD;&#x5904;&#x7406;
                    } else if (event.detail) {//FF&#x6D4F;&#x89C8;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x662F;detail,&#x5176;&#x503C;&#x4E3A;&#x201C;&#x6B63;&#x8D1F;3&#x201D;
                        delta = -event.detail/3;
                    }

                   
                    if(_this.base64 != &apos;&apos;){

                        if(delta &lt;0){
                            _this.scaleBase +=0.010;
                        }else{
                            _this.scaleBase -=0.010;
                        }
                        _this.scaleBase = _this.scaleBase&lt;=0?0:_this.scaleBase;

                        _this.scaleX = _this.scaleBase;
                        _this.scaleY = _this.scaleBase;

                        // _this.bg_width = _this.old_bg_width * _this.scaleBase;
                        // _this.bg_height = _this.old_bg_height * _this.scaleBase;
                        // console.log(_this.bg_width);
                        // console.log(_this.bg_height);

                        // _this.initBgImgPosition();
                    }

                })

                Event.addEvents(this.$refs.cropper,&apos;mousedown&apos;,function(event){
             
                    var tmp = _this.getPosition(event);
                    var x = tmp.x,y=tmp.y;
                        
                        if(event.target.id == &apos;cropper-drag&apos;){  //&#x80CC;&#x666F;&#x56FE;&#x7684;&#x8986;&#x76D6;&#x5C42;
                            _this.disX = x - _this.translateX;
                            _this.disY = y - _this.translateY;
                        }else if(event.target.className == &apos;point&apos;){
                            _this.disX = x - event.target.offsetLeft;
                            _this.disY = y - event.target.offsetTop;

                            //&#x66F4;&#x65B0;&#x88C1;&#x526A;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x4F4D;&#x7F6E;&#x8BB0;&#x5F55;
                            _this.old_cut_width = _this.$refs.cut_cover.offsetWidth;
                            _this.old_cut_height = _this.$refs.cut_cover.offsetHeight;
                            _this.old_cut_translateX = _this.$refs.cut_cover.offsetLeft;
                            _this.old_cut_translateY = _this.$refs.cut_cover.offsetTop;


                        }else{
                            _this.disX = x - event.target.offsetLeft;
                            _this.disY = y - event.target.offsetTop;
                        }

                    _this.drag = event.target;
                })
                Event.addEvents(this.$refs.cropper,&apos;mousemove&apos;,function(event){

                    if(_this.drag === null){
                        return false;
                    }

                    var tmp = _this.getPosition(event);
                    var x = tmp.x,y=tmp.y;
                    
                    if(_this.drag.id == &apos;cropper-drag&apos;){ //&#x5728;&#x80CC;&#x666F;&#x8986;&#x76D6;&#x5C42;&#x6ED1;&#x52A8; &#x79FB;&#x52A8;&#x5E95;&#x90E8;&#x56FE;&#x7247; 

                        _this.translateX = x - _this.disX;
                        _this.translateY = y - _this.disY;
                    }

                    if(_this.drag.id == &apos;cut_cover&apos;){ //&#x79FB;&#x52A8;&#x88C1;&#x526A;&#x6846;
                         _this.cut_moving = true; 
                        

                        //&#x88C1;&#x526A;&#x6846;&#x9650;&#x5236;&#x5728;&#x5BB9;&#x5668;&#x5185;
                        var tmpX = x - _this.disX;
                        var tmpY = y - _this.disY;
                        tmpX = tmpX&lt;=0?0:(tmpX&gt;=_this.cut_maxLeft?_this.cut_maxLeft:tmpX);
                        tmpY = tmpY&lt;=0?0:(tmpY&gt;=_this.cut_maxTop?_this.cut_maxTop:tmpY);
                        _this.cut_translateX = tmpX;
                        _this.cut_translateY = tmpY;
                    }
                    if(_this.drag.id == &apos;point1&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;&#x3001;&#x4F4D;&#x7F6E;[x,y]
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){ //&#x5982;&#x679C;&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B; &#x5C31;&#x4EE5;&#x5BBD;&#x4E3A;&#x51C6; &#x5BF9;&#x9AD8;&#x5EA6;&#x505A;&#x9650;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = _this.old_cut_height-(y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        // &#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B;  &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);


                    }

                    if(_this.drag.id == &apos;point2&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x9AD8; &#x4F4D;&#x7F6E;y
 

                        // _this.cut_width = _this.old_cut_width-(x - _this.disX);
                        _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x9AD8;&#x4E3A;&#x51C6;
                            _this.cut_width = _this.cut_height * _this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);


                         // &#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B;  &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);
                    }
                    if(_this.drag.id == &apos;point3&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;&#x3001;&#x4F4D;&#x7F6E;y
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = _this.old_cut_height-(y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateY = _this.old_cut_translateY +(_this.old_cut_height - _this.cut_height);
                    }
                    if(_this.drag.id == &apos;point4&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = _this.old_cut_height-(y - _this.disY);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;

                    }
                    if(_this.drag.id == &apos;point5&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8;
 

                        _this.cut_width = (x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = (y - _this.disY+5);
                        }


                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);
                    }
                    if(_this.drag.id == &apos;point6&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x9AD8;
 

                        // _this.cut_width = (x - _this.disX+5);
                        _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_width = _this.cut_height * _this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);
                    }
                    if(_this.drag.id == &apos;point7&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD;&#x3001;&#x9AD8; &#x4F4D;&#x7F6E;x
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){  //&#x56FA;&#x5B9A;&#x6BD4;&#x4F8B;&#x65F6; &#x4EE5;&#x5BBD;&#x4E3A;&#x51C6;
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }else{
                            _this.cut_height = (y - _this.disY+5);
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);

                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);

                    }
                    if(_this.drag.id == &apos;point8&apos;){   //&#x5F71;&#x54CD;&#x88C1;&#x526A;&#x6846;&#x5BBD; &#x4F4D;&#x7F6E;x
 

                        _this.cut_width = _this.old_cut_width-(x - _this.disX+5);
                        // _this.cut_height = (y - _this.disY+5);

                        if(_this.fixed){
                            _this.cut_height = _this.cut_width/_this.fixedRate;
                        }

                        //point&#x5757;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x4F4D;&#x7F6E;&#x5373;&#x4E3A;&#x88C1;&#x526A;&#x6846;&#x7684;[x,y] 
                        // _this.cut_translateX = _this.old_cut_translateX +(x - _this.disX + 5);
                        // // _this.cut_translateY = _this.old_cut_translateY +(y - _this.disY + 5);


                        //&#x4EE5;&#x4E0A;&#x8BA1;&#x7B97;&#x53D8;&#x5F62;&#x4E00;&#x4E0B; &#x4EE5;&#x5BBD; &#x9AD8;&#x4E3A;&#x53D8;&#x91CF;&#x505A;&#x8BA1;&#x7B97;
                        _this.cut_translateX = _this.old_cut_translateX +(_this.old_cut_width - _this.cut_width);


                    }


                    
                })
                Event.addEvents(this.$refs.cropper,&apos;mouseup&apos;,function(){
                    _this.cut_moving = false;
                    _this.drag = null
                })
            },
            initBgImgPosition:function(){ 
                //&#x521D;&#x59CB;&#x5316;&#x80CC;&#x666F;&#x56FE;&#x7247;&#x4F4D;&#x7F6E; &#x4FDD;&#x8BC1;&#x56FE;&#x7247;&#x5168;&#x90E8;&#x653E;&#x5230;&#x9884;&#x89C8;&#x6846;&#x5185; &#x5C45;&#x4E2D;&#x663E;&#x793A;
                //&#x60C5;&#x51B5;&#x4E00; &#x56FE;&#x7247;&#x5BBD;&#x9AD8;&#x5EA6;&#x90FD;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x663E;&#x793A;&#x6846;&#x7684;&#x5BBD;&#x9AD8; &#x6240;&#x4EE5;&#x56FE;&#x7247;&#x4E0D;&#x9700;&#x8981;&#x7F29;&#x653E; 
                if((this.img_width &lt;= this.cropper_width) &amp;&amp; (this.img_height &lt;= this.cropper_height)){
                    this.bg_width = this.img_width;
                    this.bg_height = this.img_height; 
                }else{
                    //&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x6BD4;&#x4F8B;
                    var cropper_rate = this.cropper_width/this.cropper_height;
                    var img_rate = this.img_width/this.img_height;
                    if(cropper_rate &gt;= img_rate){  //&#x4EE5;&#x56FE;&#x7247;&#x9AD8;&#x5EA6;&#x663E;&#x793A;&#x5168;&#x4E3A;&#x51C6; 
                        this.bg_height = this.cropper_height;
                        this.bg_width =  this.img_width/(this.img_height/this.cropper_height); 
                    }else{
                        this.bg_width = this.cropper_width;
                        this.bg_height =  this.img_height/(this.img_width/this.cropper_width); 
                    }
                }

                if(this.old_bg_width == 0){
                    this.old_bg_width = this.bg_width;
                    this.old_bg_height = this.bg_height;
                }


                this.translateX = (this.cropper_width - this.bg_width) * 0.5;
                this.translateY = (this.cropper_height - this.bg_height) * 0.5;

                if(this.init_translateX == -1){
                    this.init_translateX = this.translateX;
                    this.init_translateY = this.translateY;

                }

            },
            toBase64:function(file){
                var _this = this;
                let reader = new FileReader();
                reader.onload =  function(evt) {
                  var base64 = evt.target.result

                      var img = new Image();
                      img.onload = function(){
                          
                        _this.img_width = this.width;
                        _this.img_height = this.height;

                        //&#x521D;&#x59CB;&#x5316;
                        _this.scaleBase = 1,
                        _this.scaleX = 1,
                        _this.scaleY = 1,
                        _this.old_bg_width = 0;
                        _this.init_translateX = -1;

                        _this.initBgImgPosition();
                        _this.base64 = base64;
                      } 
                      img.src = base64;
                };
                reader.readAsDataURL(file); 
            },
            addImg:function(e){ 
                this.toBase64(e.target.files[0]);
            }, 
            cut4:function(){  //&#x5BF9;cut3&#x7684;&#x4F18;&#x5316;  &#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x6D4B;&#x8BD5;&#x9A8C;&#x8BC1;
                 if(this.base64 == &apos;&apos;){
                    return false;
                } 
 
                //&#x56E0;&#x4E3A;scale&#x6837;&#x5F0F;&#x4E0D;&#x80FD;&#x5177;&#x4F53;&#x4F53;&#x73B0;&#x5B9E;&#x9645;&#x5927;&#x5C0F; &#x6240;&#x4EE5;&#x5F97;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x65F6;&#x5019; &#x5E95;&#x56FE;&#x76F8;&#x5BF9;&#x4E8E;&#x6574;&#x4F53;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                var w = this.bg_width * this.scaleBase;
                var h = this.bg_height * this.scaleBase;

                // console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x5BBD;&#x5EA6;&#xFF1A;&apos;+w);
                // console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x9AD8;&#x5EA6;&#xFF1A;&apos;+h);


                //&#x7F29;&#x653E;&#x540E;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;
                // var off_scale_x = x - w * 0.5;
                // var off_scale_y = y - h * 0.5;
                // var off_scale_x = x - this.cropper_width * 0.5;
                // var off_scale_y = y - this.cropper_height * 0.5;
                // var off_scale_x = this.cropper_width*0.5 - w * 0.5;
                // var off_scale_y = this.cropper_height*0.5 - h * 0.5;
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateX:&apos;+this.init_translateX);
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateY:&apos;+this.init_translateY);

                //&#x8BA1;&#x7B97;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x521D;&#x59CB;&#x4F4D;&#x7F6E;&#x79FB;&#x52A8;&#x4E86;&#x591A;&#x5C11; 
                //&#x6B63;&#x503C;&#x662F;&#x5411;&#x4E0A; &#x5411;&#x5DE6;&#x79FB;&#x4E86;
                //&#x8D1F;&#x503C;&#x662F;&#x5411;&#x4E0B; &#x5411;&#x53F3;&#x79FB;&#x4E86;
                var dis_x = this.init_translateX - this.translateX;
                var dis_y = this.init_translateY - this.translateY;
                // console.log(&apos;dis_x:&apos;+dis_x);
                // console.log(&apos;dis_y:&apos;+dis_y);

                // var off_scale_x = (this.cropper_width - w)*0.5-dis_x;
                // var off_scale_y = (this.cropper_height - h)*0.5-dis_y;
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;x:&apos;+this.init_centerX);
                // console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;y:&apos;+this.init_centerY);

                var center_x = (this.init_centerX - dis_x);
                var center_y = (this.init_centerY - dis_y);
                
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;x:&apos;+center_x);
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;y:&apos;+center_y);

                var off_scale_x = center_x - w*0.5;
                var off_scale_y = center_y - h*0.5;



                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;x&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_x);
                // console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;y&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_y);

                    var canvas = document.createElement(&apos;canvas&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);


                canvas.width = this.cut_width;
                canvas.height = this.cut_height;


                //&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x6574;&#x4F53;&#x5C0F;&#x4E8E;&#x5BB9;&#x5668;
                if((this.img_width &lt;= this.cropper_width) &amp;&amp; (this.img_height &lt;= this.cropper_height)){
                    ctx.drawImage(
                        this.$refs.cut_img,
                        (this.cut_translateX - (off_scale_x))/this.scaleBase,
                        (this.cut_translateY - (off_scale_y))/this.scaleBase, 

                        this.cut_width/this.scaleBase,
                        this.cut_height/this.scaleBase,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL(&quot;image/png&quot;, 1.0));
                }else{
                    // console.log(&apos;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x5927;&#x4E8E;&#x5BB9;&#x5668;&apos;);
                    //&#x8BA1;&#x7B97;&#x521D;&#x59CB;&#x663E;&#x793A;&#x56FE;&#x7247;&#x65F6; &#x5C3A;&#x5BF8;&#x4E0E;&#x539F;&#x56FE;&#x7684;&#x6BD4;&#x4F8B;
                    var cropper_rate = this.cropper_width/this.cropper_height;
                    var img_rate = this.img_width/this.img_height;
                    if(cropper_rate &gt;= img_rate){  //&#x4EE5;&#x56FE;&#x7247;&#x9AD8;&#x5EA6;&#x663E;&#x793A;&#x5168;&#x4E3A;&#x51C6; 
                        // console.log(&apos;&#x4EE5;&#x9AD8;&#x5EA6;&#x6BD4;&#x4F8B;&#x4E3A;&#x51C6;&apos;)
                        var scale_rate = this.cropper_height/this.img_height;

                    }else{
                        // console.log(&apos;&#x4EE5;&#x5BBD;&#x5EA6;&#x6BD4;&#x4F8B;&#x4E3A;&#x51C6;&apos;)

                        var scale_rate = this.cropper_width/this.img_width;
                        // console.log(&apos;&#x521D;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E0E;&#x539F;&#x56FE;&#x6BD4;&#x4F8B;&#xFF1A;&apos;+scale_rate);
                    }


                    ctx.drawImage(
                        this.$refs.cut_img,
                        ((this.cut_translateX - (off_scale_x))/this.scaleBase)/scale_rate,
                        ((this.cut_translateY - (off_scale_y))/this.scaleBase)/scale_rate, 

                        (this.cut_width/this.scaleBase)/scale_rate,
                        (this.cut_height/this.scaleBase)/scale_rate,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL(&quot;image/png&quot;, 1.0));



                }

                

            },
            cut3:function(){  //&#x7B97;&#x5BF9;&#x4E86; &#x4F46;&#x662F;&#x590D;&#x6742;  &#x591A;&#x4E86;&#x4E00;&#x5C42;&#x4E34;&#x65F6;&#x753B;&#x5E03;&#x7684;&#x8FC7;&#x7A0B;
                if(this.base64 == &apos;&apos;){
                    return false;
                } 
 
                //&#x56E0;&#x4E3A;scale&#x6837;&#x5F0F;&#x4E0D;&#x80FD;&#x5177;&#x4F53;&#x4F53;&#x73B0;&#x5B9E;&#x9645;&#x5927;&#x5C0F; &#x6240;&#x4EE5;&#x5F97;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x7F29;&#x653E;&#x65F6;&#x5019; &#x5E95;&#x56FE;&#x76F8;&#x5BF9;&#x4E8E;&#x6574;&#x4F53;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                var w = this.bg_width * this.scaleBase;
                var h = this.bg_height * this.scaleBase;

                console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x5BBD;&#x5EA6;&#xFF1A;&apos;+w);
                console.log(&apos;&#x5B9E;&#x9645;&#x7684;&#x9AD8;&#x5EA6;&#xFF1A;&apos;+h);


                //&#x7F29;&#x653E;&#x540E;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;
                // var off_scale_x = x - w * 0.5;
                // var off_scale_y = y - h * 0.5;
                // var off_scale_x = x - this.cropper_width * 0.5;
                // var off_scale_y = y - this.cropper_height * 0.5;
                // var off_scale_x = this.cropper_width*0.5 - w * 0.5;
                // var off_scale_y = this.cropper_height*0.5 - h * 0.5;
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateX:&apos;+this.init_translateX);
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;translateY:&apos;+this.init_translateY);

                console.log(&apos;&#x5F53;&#x524D;&#x56FE;&#x7247;translateX:&apos;+this.translateX);
                console.log(&apos;&#x5F53;&#x524D;&#x56FE;&#x7247;translateY:&apos;+this.translateY);
                console.log(this.init_translateX - this.translateX);
                //&#x8BA1;&#x7B97;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x521D;&#x59CB;&#x4F4D;&#x7F6E;&#x79FB;&#x52A8;&#x4E86;&#x591A;&#x5C11; 
                //&#x6B63;&#x503C;&#x662F;&#x5411;&#x4E0A; &#x5411;&#x5DE6;&#x79FB;&#x4E86;
                //&#x8D1F;&#x503C;&#x662F;&#x5411;&#x4E0B; &#x5411;&#x53F3;&#x79FB;&#x4E86;
                var dis_x = this.init_translateX - this.translateX;
                var dis_y = this.init_translateY - this.translateY;
                console.log(&apos;dis_x:&apos;+dis_x);
                console.log(&apos;dis_y:&apos;+dis_y);

                // var off_scale_x = (this.cropper_width - w)*0.5-dis_x;
                // var off_scale_y = (this.cropper_height - h)*0.5-dis_y;
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;x:&apos;+this.init_centerX);
                console.log(&apos;&#x521D;&#x59CB;&#x5316;&#x5E95;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x5750;&#x6807;y:&apos;+this.init_centerY);

                var center_x = (this.init_centerX - dis_x);
                var center_y = (this.init_centerY - dis_y);
                
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;x:&apos;+center_x);
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x70B9;y:&apos;+center_y);

                var off_scale_x = center_x - w*0.5;
                var off_scale_y = center_y - h*0.5;



                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;x&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_x);
                console.log(&apos;&#x7F29;&#x653E;&#x540E;&#x7684;y&#x7684;&#x504F;&#x79FB;&#xFF1A;&apos;+off_scale_y);

 

                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = w;
                old_canvas.height = h;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.img_width,this.img_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )

                    // console.log(old_canvas.toDataURL());


                setTimeout(()=&gt;{
                    var canvas = document.createElement(&apos;canvas&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);


                canvas.width = this.cut_width;
                canvas.height = this.cut_height;

                ctx.drawImage(
                        old_canvas,
                        this.cut_translateX - (off_scale_x),
                        this.cut_translateY - (off_scale_y), 

                        this.cut_width,
                        this.cut_height,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL());
                },200)
                


            },
            cut2:function(){  //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;
                if(this.base64 == &apos;&apos;){
                    return false;
                }
                console.log(this.$refs.front.getBoundingClientRect());



                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )


                setTimeout(()=&gt;{

                    var canvas = document.createElement(&apos;canvas&apos;);
                    var ctx = canvas.getContext(&apos;2d&apos;);
                    ctx.scale(this.scaleBase,this.scaleBase);

    
                    canvas.width = this.cut_width;
                    canvas.height = this.cut_height;

                    

                    // var startX = -(this.frontX);
                    // var startY = -(this.frontY);

                    //&#x7F29;&#x653E;&#x540E;&#x56FE;&#x7247;&#x76F8;&#x5BF9;&#x4E8E;&#x533A;&#x57DF;&#x7684;&#x4F4D;&#x7F6E;
                    var startX = (-this.translateX/this.scaleBase)*0.5;
                    var startY = (-this.translateY/this.scaleBase)*0.5;
                    console.log(startX);
                    console.log(startY);



                    ctx.drawImage(
                        old_canvas,
                        startX,
                        startY, 

                        this.cut_width,
                        this.cut_height,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                    
                    console.log(canvas.toDataURL());

                },200)



                // var canvas = document.createElement(&apos;canvas&apos;);
                // var ctx = canvas.getContext(&apos;2d&apos;);
                // ctx.scale(this.scaleBase,this.scaleBase);

 
                // canvas.width = this.cut_width;
                // canvas.height = this.cut_height;
                // var startX = this.cut_translateX - this.translateX/this.scaleBase;
                // var startY = this.cut_translateY - this.translateY/this.scaleBase;

                // console.log(startX);
                // console.log(startY);


                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,
                //     startY, 

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());
            },
            cut1:function(){  //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;

                if(this.base64 == &apos;&apos;){
                    return false;
                }

                var old_canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;
                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0, this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                )

                console.log(old_canvas.toDataURL())

                var canvas = document.createElement(&apos;canvas&apos;);
                canvas.width = this.cut_width;
                canvas.height = this.cut_height;
                var ctx = canvas.getContext(&apos;2d&apos;);

                var startX = this.cut_translateX - this.translateX;
                var startY = this.cut_translateY - this.translateY;
                console.log(startX);
                console.log(startY);


              

                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,startY,

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());

                


            },

            cut:function(){ //&#x5931;&#x8D25; &#x6CA1;&#x7B97;&#x5BF9;

                if(this.base64 == &apos;&apos;){
                    return false;
                }
                var old_canvas = document.createElement(&apos;canvas&apos;);
                var canvas = document.createElement(&apos;canvas&apos;);
                var old_ctx = old_canvas.getContext(&apos;2d&apos;);
                var ctx = canvas.getContext(&apos;2d&apos;);
                // ctx.scale(this.scaleBase,this.scaleBase);

                old_canvas.width = this.$refs.front_img.offsetWidth*this.scaleBase;
                old_canvas.height = this.$refs.front_img.offsetHeight*this.scaleBase;

                canvas.width = this.cut_width;
                canvas.height = this.cut_height;
                console.log(this.$refs.front_img.offsetWidth*this.scaleBase);

                old_ctx.drawImage(
                    this.$refs.cut_img,
                    0,0,this.bg_width,this.bg_height,
                    0,0,
                    old_canvas.width,
                    old_canvas.height
                    )

                console.log(old_canvas.toDataURL());
                setTimeout(()=&gt;{

                    ctx.drawImage(
                        old_canvas,
                        -(this.frontX),
                        -(this.frontY),
                        this.cut_width*this.scaleBase,
                        this.cut_height*this.scaleBase,
                        0,0,
                        this.cut_width,
                        this.cut_height,
                        )
                console.log(canvas.toDataURL());

                },200)
                   

                // var new_translateX = this.translateX/this.scaleBase;
                // var new_translateY = this.translateY/this.scaleBase;
                // var new_width = this.cut_width*this.scaleBase;
                // var new_height = this.cut_height*this.scaleBase;
                // console.log(&apos;-----&apos;)
                // console.log(this.scaleBase);
                // console.log(new_translateX);
                // console.log(new_width);

                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     this.cut_translateX - new_translateX,
                //     this.cut_translateX - new_translateY, 

                //     new_width,
                //     new_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());



                // var startX = this.cut_translateX - this.translateX/this.scaleBase;
                // var startY = this.cut_translateY - this.translateY/this.scaleBase;

                // console.log(startX);
                // console.log(startY);


                // ctx.drawImage(
                //     this.$refs.cut_img,
                //     startX,
                //     startY, 

                //     this.cut_width,
                //     this.cut_height,
                //     0,0,
                //     this.cut_width,
                //     this.cut_height,
                //     )
                
                // console.log(canvas.toDataURL());

            }
        },
        mounted(){
            this.cropper_width = this.$refs.cropper.offsetWidth;
            this.cropper_height = this.$refs.cropper.offsetHeight;

            this.init_centerX = this.cropper_width * 0.5;
            this.init_centerY = this.cropper_height * 0.5;
            

            this.init_cut();

            this.limitRange();
            this.initEvent();
        },
        computed:{
            frontX(){
                return this.translateX-this.cut_translateX;
            },
            frontY(){
                return this.translateY-this.cut_translateY;
            }
        }
    })
}

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

">
      <input type="hidden" id="init-css12" value="">
      <input type="hidden" id="init-js12" value="">
      <input type="hidden" id="init-active12" value="html">
  
      <div style="display:none;">
        <form method="post" id="codepen-form12" action="//codepen.io/pen/define" target="check">
          <input id="codepen-data12" type="hidden" name="data">
          <input type="hidden" name="wrap" value="l">
        </form>
      </div>
    </div>
   </p>
<footer class="page-footer"><span class="copyright">&#xA9; Collect all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2021-06-28 11:55:08
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="diyPromise.html" class="navigation navigation-prev " aria-label="Previous page: 实现类Promise">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="problem.html" class="navigation navigation-next " aria-label="Next page: 疑难问题">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"在线裁图","level":"1.3.14","depth":2,"next":{"title":"疑难问题","level":"1.4","depth":1,"path":"problem.md","ref":"problem.md","articles":[{"title":"video标签不能自动播放问题","level":"1.4.1","depth":2,"path":"video.md","ref":"video.md","articles":[]}]},"previous":{"title":"实现类Promise","level":"1.3.13","depth":2,"path":"diyPromise.md","ref":"diyPromise.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","tbfed-pagefooter","sidebar-style","auto-scroll-table","code-editor","code"],"styles":{"website":"example/style/website.css"},"pluginsConfig":{"sidebar-style":{"author":"志成","title":"工作中的一些收集"},"tbfed-pagefooter":{"copyright":"&copy Collect","modify_label":"文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"search":{},"auto-scroll-table":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code-editor":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"expandable-chapters-small":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"lizhicheng","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"工作中的一些收集","output.name":"工作中的一些收集","gitbook":"*","description":"工作中的一些收集"},"file":{"path":"cutImg.md","mtime":"2021-06-28T03:55:08.711Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-28T04:47:12.536Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sidebar-style/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="http://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ace.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code-editor/editor.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

